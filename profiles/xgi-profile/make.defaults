CFLAGS="-march=native ${CFLAGS} -pipe -D_FORTIFY_SOURCE=2 -Werror=format-security -fstack-clash-protection -D_GLIBCXX_ASSERTIONS"
CXXFLAGS="${CFLAGS}"
FCFLAGS="${CFLAGS}"
FFLAGS="${CFLAGS}"
LDFLAGS="${CFLAGS} ${LDFLAGS} -Wl,-O2 -Wl,-z,relro,-z,now"
RUSTFLAGS="-C target-cpu=native -C opt-level=3 -Clinker-plugin-lto -C embed-bitcode=no"

GNOME="modemmanager -weather -geolocation gnome-online-accounts -browser-extension gnome-shell gnome gtk4 oauth webkit"
KDE="-crash-handler -handbook -display-manager -firewall -legacy-systray -sddm -vlc -webengine"
AV_CODECS="a52 aac avif dav1d dts encode exif ffmpeg gif flac heif jpeg jpeg2k ladspa libgig lv2 mad midi mng mp3 mp4 mpeg ogg openh264 opus png svg tiff vaapi vorbis vpx webp x264 x265"
COMPRESSION="archive blake2 brotli bzip2 lz4 lzma lzo rar zip zlib zstd"
NET="curl gstreamer idn ipv6 iwd networkmanager nfs nftables quiche resolvconf samba sctp snmp wifi zeroconf bpf libproxy"
SECURITY="acl apparmor audit cacert caps cet crypt gcrypt gnutls pkcs7 pkcs11 seccomp ssl hardened pie ssp kerberos gnome-keyring xxhash tpm"
GRAPHICS="cairo drm egl eglfs gbm gegl gles1 gles2 gtk gtk3 gui kms layers libkms modern-top ncurses opengl pango sdl vulkan wayland widgets wxwidgets tk"
USELESS="-abi_x86_32 -berkdb -cdda -cdio -doc -dvd -dvdnav -fbdev -geolocation -gpm -gtk2 -doc -ldap -passwdqc -smartcard -spell -tcl -tcpd -ttf -vdpau -xv"

USE="${AV_CODECS} ${COMPRESSION} ${NET} ${SECURITY} ${GRAPHICS} ${KDE} ${GNOME} ${USELESS} alsa bluetooth boost branding cjk clang cli cups dbus device-mapper expat fontconfig fortran gdbm git gmp iconv icu jack jemalloc jit lcms libnotify libtirpc llvm-libunwind lm-sensors lto lvm metric modern-top mtp multilib multitarget nls nptl numa openmp pcre pdf pgo pipewire pulseaudio readline scanner session sound split-usr startup-notification syslog threads truetype udev unicode upower usb user-session vim-syntax xattr xml zsh-completion colord opencl cxx mpi hwloc hugepages otf mpfr tdb sqlite screencast glib"

INPUT_DEVICES="libinput"
RUBY_TARGETS="ruby31"
LUA_SINGLE_TARGET="luajit"
LUA_TARGETS="luajit"
PYTHON_SINGLE_TARGET="python3_10"
PYTHON_TARGETS="python3_10"
SANE_BACKENDS="net"
